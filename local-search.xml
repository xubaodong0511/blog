<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>查看面板选项工具箱-函数定义</title>
    <link href="/2025/01/09/%E6%9F%A5%E7%9C%8B%E9%9D%A2%E6%9D%BF%E9%80%89%E9%A1%B9%E5%B7%A5%E5%85%B7%E7%AE%B1-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89/"/>
    <url>/2025/01/09/%E6%9F%A5%E7%9C%8B%E9%9D%A2%E6%9D%BF%E9%80%89%E9%A1%B9%E5%B7%A5%E5%85%B7%E7%AE%B1-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89/</url>
    
    <content type="html"><![CDATA[<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># !/bin/bash</span><br><span class="hljs-comment"># 打印工具箱</span><br><br><span class="hljs-comment">#定义菜单函数</span><br>caidan ()&#123;<br>cat &lt;&lt; EOF<br>-----------系统工具箱----------<br>|       <span class="hljs-number">1</span>.查看磁盘信息        |<br>|       <span class="hljs-number">2</span>.查看内存信息        |<br>|       <span class="hljs-number">3</span>.查看CPU信息         |<br>|       <span class="hljs-number">4</span>.查看网络信息        |<br>|       <span class="hljs-number">5</span>.查看进程信息        |<br>|       <span class="hljs-number">6</span>.退出                |<br>-------------------------------<br>EOF<br>&#125;<br><br><span class="hljs-comment"># while循环选项操作</span><br><span class="hljs-keyword">while</span> :<br><span class="hljs-keyword">do</span><br>caidan<br>read -p <span class="hljs-string">&quot;请输出你的选择[1..6]&quot;</span> num<br><span class="hljs-comment"># case语句循环选项</span><br>case <span class="hljs-variable">$num</span> <span class="hljs-keyword">in</span><br><span class="hljs-number">1</span>)<br>echo <span class="hljs-string">&quot;=====磁盘信息=====&quot;</span><br>df -hT<br>echo <span class="hljs-string">&quot;=====磁盘信息=====&quot;</span><br>read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br><span class="hljs-comment">#if语句判断是否要继续面板选项</span><br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>clear<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>fi<br>;;<br><span class="hljs-number">2</span>)<br>echo <span class="hljs-string">&quot;=====内存信息=====&quot;</span><br>free -m<br>echo <span class="hljs-string">&quot;=====内存信息=====&quot;</span><br>               read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>                        clear<br>                <span class="hljs-keyword">else</span><br>                        <span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>                fi<br>;;<br><span class="hljs-number">3</span>)<br>echo <span class="hljs-string">&quot;=====CPU信息=====&quot;</span><br>uptime<br>echo <span class="hljs-string">&quot;=====CPU信息=====&quot;</span><br>               read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>                        clear<br>                <span class="hljs-keyword">else</span><br>                        <span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>                fi<br>;;<br><span class="hljs-number">4</span>)<br>echo <span class="hljs-string">&quot;=====网络信息=====&quot;</span><br>read -p <span class="hljs-string">&quot;请输入你要用的网络接口号&quot;</span> hao<br>netstat -anpt | grep <span class="hljs-variable">$hao</span><br>echo <span class="hljs-string">&quot;=====网络信息=====&quot;</span><br>               read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>                        clear<br>                <span class="hljs-keyword">else</span><br>                        <span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>                fi<br>;;<br><span class="hljs-number">5</span>)<br>echo <span class="hljs-string">&quot;=====进程信息=====&quot;</span><br>read -p <span class="hljs-string">&quot;请输入你要查询的进程名&quot;</span> pss<br>ps aux | grep <span class="hljs-variable">$pss</span><br>echo <span class="hljs-string">&quot;=====进程信息=====&quot;</span><br>               read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>                        clear<br>                <span class="hljs-keyword">else</span><br>                        <span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>                fi<br>;;<br><span class="hljs-number">6</span>)<br>echo <span class="hljs-string">&quot;=======退出=======&quot;</span><br><span class="hljs-keyword">exit</span> <span class="hljs-number">88</span><br>echo <span class="hljs-string">&quot;=======退出=======&quot;</span><br>;;<br><br>*)<br>caidan<br>               read -p <span class="hljs-string">&quot;继续y，退出n&quot;</span> yn<br>                <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$yn</span> = y ];then<br>                        clear<br>                <span class="hljs-keyword">else</span><br>                        <span class="hljs-keyword">break</span> <span class="hljs-number">88</span><br>                fi<br>;;<br>esac<br>done<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>toolbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux网卡配置</title>
    <link href="/2025/01/08/linux%E7%BD%91%E5%8D%A1%E9%85%8D%E7%BD%AE/"/>
    <url>/2025/01/08/linux%E7%BD%91%E5%8D%A1%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<p><strong>永久设置网卡</strong></p><blockquote><p><code>另外也可以在终端上输入nmtui，进入网卡设置界面</code></p></blockquote><p><strong>1、Centos 7 配置</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">Centos 7<br><span class="hljs-meta prompt_"># </span><span class="language-bash">vim/etc/sysconfig/network-scripts/ifcfg-ens33 //网卡配置文件的路径</span><br>TYPE=Ethernet//网卡类型<br>BOOTPROTO=dhcp //网卡模式<br>     --&gt;  dhcp //自动获取<br>     --&gt;  static //手动获取<br>     --&gt;  none //手动获取<br>NAME=ens33 //网卡名称（可以修改的）<br>DEVICE=ens33 //设备名称<br>ONBOOT=yes //网卡开关<br>IPADDR=192.168.10.104//IP地址<br>PREFIX=24//子网掩码<br>NETMASK=255.255.255.0 //子网掩码<br>GATEWAY=192.168.10.2 //网关<br>DNS1=192.168.10.2 //DNS<br></code></pre></td></tr></table></figure><p><strong>重启</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">systemctl restart network //重启网卡生效配置<br></code></pre></td></tr></table></figure><p><strong>2、Centos 9 配置</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">Centos9<br><span class="hljs-meta prompt_"># </span><span class="language-bash">vim /etc/NetworkManager/system-connections/ens33.nmconnection  //修改如下选项即可</span><br>address=192.168.10.120/24,192.168.26.2  //ip地址，子网掩码，网关<br>dns=192.168.10.2       //DNS<br>method=manual <br><span class="hljs-meta prompt_">   --&gt; </span><span class="language-bash">manual          //手动</span><br><span class="hljs-meta prompt_">   --&gt; </span><span class="language-bash">auto            //自动</span><br></code></pre></td></tr></table></figure><p><strong>重启</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">nmcli c reload      //重启网络服务 <br>nmcli c down ens33  //开启网络 <br>nmcli c up ens33    //关闭网络<br></code></pre></td></tr></table></figure><p><strong>3、当network和networkmanager 网卡冲突</strong></p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gauss">systemctl <span class="hljs-keyword">stop</span> NetworkManager <br><br>systemctl disabled NetworkManager   <span class="hljs-comment">//将NetworkManger停止</span><br><br>ifup ens33          <span class="hljs-comment">//输入此命令即可查看ens33网卡</span><br><br>systemctl restart network          <span class="hljs-comment">//重启网卡服务</span><br><br><span class="hljs-meta"># 此时应该就可以看到ens33的IP地址了</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQL全量备份/增量备份脚本</title>
    <link href="/2025/01/07/MySQL%E5%85%A8%E9%87%8F%E5%A4%87%E4%BB%BD-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC/"/>
    <url>/2025/01/07/MySQL%E5%85%A8%E9%87%8F%E5%A4%87%E4%BB%BD-%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<p>#!&#x2F;bin&#x2F;bash</p><h1 id="mysql物理备份脚本"><a href="#mysql物理备份脚本" class="headerlink" title="mysql物理备份脚本"></a>mysql物理备份脚本</h1><h1 id="每周日进行全量备份，周一到周六进行增量备份，7天为一个周期"><a href="#每周日进行全量备份，周一到周六进行增量备份，7天为一个周期" class="headerlink" title="每周日进行全量备份，周一到周六进行增量备份，7天为一个周期"></a>每周日进行全量备份，周一到周六进行增量备份，7天为一个周期</h1><h1 id="备份路径、日志路径"><a href="#备份路径、日志路径" class="headerlink" title="备份路径、日志路径"></a>备份路径、日志路径</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">backup_dir</span>=<span class="hljs-string">&quot;/backup&quot;</span><br><span class="hljs-attr">log_dir</span>=<span class="hljs-string">&quot;/backup/log&quot;</span><br><span class="hljs-attr">full_backup_dir</span>=<span class="hljs-string">&quot;/backup/full&quot;</span><br><span class="hljs-attr">inc_backup_dir</span>=<span class="hljs-string">&quot;/backup/inc&quot;</span><br><br><span class="hljs-attr">log_date</span>=$(date <span class="hljs-string">&quot;+%F-%T&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="数据库用户、密码"><a href="#数据库用户、密码" class="headerlink" title="数据库用户、密码"></a>数据库用户、密码</h1><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">MY_USER</span>=root<br><span class="hljs-attr">MY_PASS</span>=P@ssword1<br></code></pre></td></tr></table></figure><h1 id="判断日志、备份路径是否存在"><a href="#判断日志、备份路径是否存在" class="headerlink" title="判断日志、备份路径是否存在"></a>判断日志、备份路径是否存在</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[ -d <span class="hljs-variable">$backup_dir</span> ] || <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$backup_dir</span><br>[ -d <span class="hljs-variable">$log_dir</span> ] || <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$log_dir</span><br>[ -d <span class="hljs-variable">$full_backup_dir</span> ] || <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$full_backup_dir</span><br>[ -d <span class="hljs-variable">$inc_backup_dir</span> ] || <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$inc_backup_dir</span><br></code></pre></td></tr></table></figure><h1 id="全量备份函数"><a href="#全量备份函数" class="headerlink" title="全量备份函数"></a>全量备份函数</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">full_backup</span></span>()&#123;<br><span class="hljs-comment"># 全量备份命令 </span><br>innobackupex --user=<span class="hljs-variable">$MY_USER</span> --password=<span class="hljs-variable">$MY_PASS</span> <span class="hljs-variable">$full_backup_dir</span><br><span class="hljs-keyword">if</span> [ $? -eq 0 ];<span class="hljs-keyword">then</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> full backup!!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/back.log<br><span class="hljs-keyword">else</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> full failed!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/err.log<br><span class="hljs-keyword">fi</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="获取上周日的时间-以-Y-m-d格式显示"><a href="#获取上周日的时间-以-Y-m-d格式显示" class="headerlink" title="获取上周日的时间,以%Y-%m-%d格式显示"></a>获取上周日的时间,以%Y-%m-%d格式显示</h1><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">sunday=$(<span class="hljs-keyword">date</span> -d <span class="hljs-string">&quot;last sunday&quot;</span> +%F)<br></code></pre></td></tr></table></figure><h1 id="获取前一天的时间-以-Y-m-d格式显示"><a href="#获取前一天的时间-以-Y-m-d格式显示" class="headerlink" title="获取前一天的时间,以%Y-%m-%d格式显示"></a>获取前一天的时间,以%Y-%m-%d格式显示</h1><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">yesterday=$(<span class="hljs-keyword">date</span> -d <span class="hljs-string">&quot;yesterday&quot;</span> +%F)<br></code></pre></td></tr></table></figure><h1 id="增量备份函数"><a href="#增量备份函数" class="headerlink" title="增量备份函数"></a>增量备份函数</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">inc_backup</span></span>()&#123;<br><span class="hljs-comment"># 判断当前时间是否为周一(周一需要去找全量备份，周二到周六找前一天的备份)</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$week_date</span> -eq 1 ];<span class="hljs-keyword">then</span><br><span class="hljs-comment"># 查找全量备份的文件路径</span><br><span class="hljs-built_in">local</span> full_backup_dir=$(find <span class="hljs-variable">$backup_dir</span> -name <span class="hljs-variable">$&#123;sunday&#125;</span>*)<br>innobackupex --user=<span class="hljs-variable">$MY_USER</span> --password=<span class="hljs-variable">$MY_PASS</span> --incremental <span class="hljs-variable">$&#123;inc_backup_dir&#125;</span> --incremental-basedir=<span class="hljs-variable">$&#123;full_backup_dir&#125;</span><br><span class="hljs-comment"># 判断命令是否执行成功,写入日志文件</span><br>    <span class="hljs-keyword">if</span> [ $? -eq 0 ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> inc backup!!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/back.log<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> inc failed!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/err.log<br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">else</span><br><span class="hljs-comment"># 查找前一天的文件路径</span><br>        <span class="hljs-built_in">local</span> yesterday_backup_dir=$(find <span class="hljs-variable">$backup_dir</span> -name <span class="hljs-variable">$&#123;yesterday&#125;</span>*)<br>        innobackupex --user=<span class="hljs-variable">$MY_USER</span> --password=<span class="hljs-variable">$MY_PASS</span> --incremental <span class="hljs-variable">$&#123;inc_backup_dir&#125;</span> --incremental-basedir=<span class="hljs-variable">$&#123;yesterday_backup_dir&#125;</span><br><span class="hljs-comment"># 判断命令是否执行成功,写入日志文件</span><br>    <span class="hljs-keyword">if</span> [ $? -eq 0 ];<span class="hljs-keyword">then</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> inc backup!!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/back.log<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$&#123;log_date&#125;</span> inc failed!!&quot;</span> &gt;&gt; <span class="hljs-variable">$log_dir</span>/err.log<br>    <span class="hljs-keyword">fi</span><br><span class="hljs-keyword">fi</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="查看当前是周几"><a href="#查看当前是周几" class="headerlink" title="查看当前是周几"></a>查看当前是周几</h1><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">week_date=$(<span class="hljs-keyword">date</span> +%u)<br></code></pre></td></tr></table></figure><h1 id="判断当前是周几，周日则执行全量备份，周一到周六执行增量备份"><a href="#判断当前是周几，周日则执行全量备份，周一到周六执行增量备份" class="headerlink" title="判断当前是周几，周日则执行全量备份，周一到周六执行增量备份"></a>判断当前是周几，周日则执行全量备份，周一到周六执行增量备份</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$week_date</span> -eq 7 ];<span class="hljs-keyword">then</span><br>full_backup<br><span class="hljs-keyword">else</span><br>inc_backup<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>study，MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker部署halo博客</title>
    <link href="/2025/01/06/docker%E9%83%A8%E7%BD%B2halo%E5%8D%9A%E5%AE%A2/"/>
    <url>/2025/01/06/docker%E9%83%A8%E7%BD%B2halo%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="docker博客创建"><a href="#docker博客创建" class="headerlink" title="docker博客创建"></a>docker博客创建</h1><h2 id="编辑配置文件"><a href="#编辑配置文件" class="headerlink" title="编辑配置文件"></a>编辑配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /halo/docker-compose.yaml<br>version: <span class="hljs-string">&quot;3&quot;</span><br><br>services:<br>  halo<br>    image: halohub/halo:2.11<br>    container_name: halo<br>    restart: on-failure:3<br>    depends_on:<br>      halodb:<br>        condition: service_healthy<br>    networks:<br>      halo_network:<br>    volumes:<br><br>   - ./halo2:/root/.halo2<br>     rts:<br>        - <span class="hljs-string">&quot;8090:8090&quot;</span><br>          althcheck:<br>                <span class="hljs-built_in">test</span>: [<span class="hljs-string">&quot;CMD&quot;</span>, <span class="hljs-string">&quot;curl&quot;</span>, <span class="hljs-string">&quot;-f&quot;</span>, <span class="hljs-string">&quot;http://localhost:8090/actuator/health/readiness&quot;</span>]<br>                interval: 30s<br>                <span class="hljs-built_in">timeout</span>: 5s<br>                retries: 5<br>                start_period: 30s          <br>              <span class="hljs-built_in">command</span>:<br>             - --spring.r2dbc.url=r2dbc:pool:postgresql://halodb/halo<br>               --spring.r2dbc.username=halo<br><br>      <span class="hljs-comment"># PostgreSQL 的密码，请保证与下方 POSTGRES_PASSWORD 的变量值一致。</span><br><br>   - --spring.r2dbc.password=openpostgresql<br>     --spring.sql.init.platform=postgresql<br><br>      <span class="hljs-comment"># 外部访问地址，请根据实际需要修改</span><br><br>   - --halo.external-url=http://localhost:8090/<br>     halodb:<br>         image: postgres:15.4<br>         container_name: halodb<br>         restart: on-failure:3<br>         networks:<br>           halo_network:<br>         volumes:<br>        - ./db:/var/lib/postgresql/data<br>          rts:<br>             - <span class="hljs-string">&quot;5432:5432&quot;</span><br>               althcheck:<br>                     <span class="hljs-built_in">test</span>: [ <span class="hljs-string">&quot;CMD&quot;</span>, <span class="hljs-string">&quot;pg_isready&quot;</span> ]<br>                     interval: 10s<br>                     <span class="hljs-built_in">timeout</span>: 5s<br>                     retries: 5<br>                   environment:<br>                  - POSTGRES_PASSWORD=openpostgresql<br>                    POSTGRES_USER=halo<br>                       - POSTGRES_DB=halo<br>                         PGUSER=halo<br><br>networks:<br>  halo_network:<br></code></pre></td></tr></table></figure><h2 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -pv /halo<br></code></pre></td></tr></table></figure><h2 id="重新指定文件目录"><a href="#重新指定文件目录" class="headerlink" title="重新指定文件目录"></a>重新指定文件目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> docker-compose.yaml /halo<br><span class="hljs-built_in">cd</span> /halo<br></code></pre></td></tr></table></figure><h2 id="运行以下命令卸载所有冲突的包"><a href="#运行以下命令卸载所有冲突的包" class="headerlink" title="运行以下命令卸载所有冲突的包"></a>运行以下命令卸载所有冲突的包</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">for</span> pkg <span class="hljs-keyword">in</span> docker.io docker-doc docker-compose podman-docker containerd runc; <span class="hljs-keyword">do</span> sudo apt-<span class="hljs-built_in">get</span> <span class="hljs-built_in">remove</span> <span class="hljs-variable">$pkg</span>; done<br></code></pre></td></tr></table></figure><h2 id="设置-Docker-的apt存储库"><a href="#设置-Docker-的apt存储库" class="headerlink" title="设置 Docker 的apt存储库"></a>设置 Docker 的apt存储库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Add Docker&#x27;s official GPG key:</span><br><span class="hljs-built_in">sudo</span> apt-get update<br><span class="hljs-built_in">sudo</span> apt-get install ca-certificates curl gnupg<br><span class="hljs-built_in">sudo</span> install -m 0755 -d /etc/apt/keyrings<br>curl -fsSL https://download.docker.com/linux/debian/gpg | <span class="hljs-built_in">sudo</span> gpg --dearmor -o /etc/apt/keyrings/docker.gpg<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> a+r /etc/apt/keyrings/docker.gpg<br><br><span class="hljs-comment"># Add the repository to Apt sources:</span><br><span class="hljs-built_in">echo</span> \<br>  <span class="hljs-string">&quot;deb [arch=<span class="hljs-subst">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \</span><br><span class="hljs-string">  <span class="hljs-subst">$(. /etc/os-release &amp;&amp; echo <span class="hljs-string">&quot;<span class="hljs-variable">$VERSION_CODENAME</span>&quot;</span>)</span> stable&quot;</span> | \<br>  <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null<br><span class="hljs-built_in">sudo</span> apt-get update<br></code></pre></td></tr></table></figure><h2 id="运行安装脚本"><a href="#运行安装脚本" class="headerlink" title="运行安装脚本"></a>运行安装脚本</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">bash &lt;(curl -sSL https://linuxmirrors.cn/docker.sh)    //脚本运行<br>sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin    //新版docker版本脚本<br></code></pre></td></tr></table></figure><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">apt-get install -y docker-compose<br></code></pre></td></tr></table></figure><h2 id="验证版本号"><a href="#验证版本号" class="headerlink" title="验证版本号"></a>验证版本号</h2><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">docker-compose <span class="hljs-comment">--version</span><br>docker <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><h2 id="安装运行"><a href="#安装运行" class="headerlink" title="安装运行"></a>安装运行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shel">docker-compose up -d<br>systemctl status docker<br></code></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p><code>输入IP地址+端口8090</code>进入注册页面</p>]]></content>
    
    
    
    <tags>
      
      <tag>study，blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>清风工具箱</title>
    <link href="/2025/01/06/%E6%B8%85%E9%A3%8E%E5%B7%A5%E5%85%B7%E7%AE%B1/"/>
    <url>/2025/01/06/%E6%B8%85%E9%A3%8E%E5%B7%A5%E5%85%B7%E7%AE%B1/</url>
    
    <content type="html"><![CDATA[<h2 id="工具箱一键脚本"><a href="#工具箱一键脚本" class="headerlink" title="工具箱一键脚本"></a>工具箱一键脚本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash &lt;(curl -sSL https://gitee.com/xbd666/qingfeng/raw/master/toolbox.sh)<br></code></pre></td></tr></table></figure><h2 id="脚本一键安装MySQL-mariadb-并更改密码"><a href="#脚本一键安装MySQL-mariadb-并更改密码" class="headerlink" title="脚本一键安装MySQL&#x2F;mariadb,并更改密码"></a>脚本一键安装MySQL&#x2F;mariadb,并更改密码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash &lt;(curl -sSL https://gitee.com/xbd666/qingfeng/raw/master/MySQL_install.sh)<br></code></pre></td></tr></table></figure><h2 id="添加swap分区–调用gitee仓库"><a href="#添加swap分区–调用gitee仓库" class="headerlink" title="添加swap分区–调用gitee仓库"></a>添加swap分区–调用gitee仓库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash &lt;(curl -sSL https://gitee.com/xbd666/qingfeng/raw/master/swap.sh)<br></code></pre></td></tr></table></figure><h2 id="安装前-后端软件包一键脚本"><a href="#安装前-后端软件包一键脚本" class="headerlink" title="安装前&#x2F;后端软件包一键脚本"></a>安装前&#x2F;后端软件包一键脚本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash &lt;(curl -sSL https://gitee.com/xbd666/qingfeng/raw/master/Software_package.sh)<br></code></pre></td></tr></table></figure><h2 id="gitee仓库超连接"><a href="#gitee仓库超连接" class="headerlink" title="gitee仓库超连接"></a>gitee仓库超连接</h2><p><a href="https://gitee.com/xbd666/qingfeng">gitee</a><br><a href="https://github.com/KKISO574/shell">github</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>study，toolbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2025/01/06/hello-world/"/>
    <url>/2025/01/06/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
